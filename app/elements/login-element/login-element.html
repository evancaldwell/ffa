<polymer-element name="login-element" attributes="">
  <template>
    <link rel="stylesheet" href="login-element.css">

    <!-- =========== non-display ========== -->
    <firebase-login 
        id="baseLogin" 
        user="{{user}}" 
        statusKnown="{{statusKnown}}" 
        location="https://ffapps.firebaseio.com/" 
        provider="github" 
        on-login="{{onLogin}}"
        on-error="{{onLoginError}}"></firebase-login>
    <firebase-element id="base" location="https://ffapps.firebaseio.com/" data="{{data}}" keys="{{keys}}"></firebase-element>
    <firebase-element id="users" location="https://ffapps.firebaseio.com/users/" data="{{users}}" keys="{{userKeys}}"></firebase-element>
    <pvc-globals values="{{globals}}"></pvc-globals>

    <!-- =========== display ========== -->
    <section class="full-height" horizontal center-justified center layout>
      <div>
        <paper-item on-click="{{login}}" hidden?="{{!statusKnown || user}}">Login</paper-item>
        <paper-item on-click="{{logout}}" hidden?="{{!statusKnown || !user}}">Logout</paper-item>
      </div>
    </section>

  </template>
  <script>
    (function () {
      'use strict';

      Polymer({
        // define element prototype here
        login: function() {
          this.$.baseLogin.login();
        },
        logout: function() {
          this.$.baseLogin.logout();
        },
        onLogin: function() {
          this.globals.currentUser = this.user;
          this.globals.fireKeys = this.keys;
          this.globals.fireData = this.data;
          console.log('user is: ' + JSON.stringify(this.globals.currentUser));
          console.log('data is: ' + JSON.stringify(this.globals.fireData));
        },
        onLoginError: function(err) {
          console.log('An error occurred: ' + JSON.stringify(err));
        },
        handleFBResponse: function(response) {
          console.log('FB response: ' + JSON.stringify(response));
        }
      });

    })();
  </script>
</polymer-element>
